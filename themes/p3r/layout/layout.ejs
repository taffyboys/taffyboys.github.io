<!-- <!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%- page.title || config.title %> - <%= config.author %></title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Oswald:wght@700&display=swap');
        :root { --p3-blue: #0066ff; --p3-dark: #000b1a; }
        body { background-color: var(--p3-dark); color: white; font-family: 'Oswald', sans-serif; overflow-x: hidden; }
        .bg-gradient-animate {
            background: linear-gradient(135deg, #000b1a 0%, #001a3d 50%, #002e66 100%);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
        }
        @keyframes gradientBG { 0%, 100% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } }
        .slanted-box { transform: skewX(-15deg); }
        .slanted-content { transform: skewX(15deg); }
        .shard { position: fixed; background: rgba(0, 102, 255, 0.15); clip-path: polygon(20% 0%, 80% 0%, 100% 100%, 0% 80%); z-index: -1; animation: float 8s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0) rotate(0deg); } 50% { transform: translateY(-30px) rotate(5deg); } }
        
        /* P3R 经典的切入动画 */
        @keyframes p3SlideIn {
            0% { transform: translateX(-40px) skewX(-15deg); opacity: 0; }
            100% { transform: translateX(0) skewX(0); opacity: 1; }
        }

        .animate-p3-slide {
            animation: p3SlideIn 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        /* 优化正文内的引用样式 */
        .prose blockquote {
            border-left: 4px solid #0066ff !important;
            background: #f0f7ff;
            padding: 1rem !important;
            font-style: italic;
        }

        .prose a {
            color: #0066ff;
            text-decoration: none;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
            font-weight: bold;
        }
        .prose a:hover {
            border-bottom: 2px solid #00d9ff;
            background: rgba(0, 102, 255, 0.1);
        }

        /* 针对正文内容的深度定制 */
        .prose {
            color: #1a1a1a; /* 稍微加深文字颜色，提高易读性 */
        }

        /* 定制正文中的分割线 (---) */
        .prose hr {
            margin-top: 4rem !important;    /* 极大的上边距 */
            margin-bottom: 4rem !important; /* 极大的下边距 */
            border: none;
            height: 2px;
            /* 使用渐变色，模拟 P3R 的霓虹蓝色扫描感 */
            background: linear-gradient(to right, 
                transparent, 
                var(--p3-blue) 15%, 
                #00d9ff 50%, 
                var(--p3-blue) 85%, 
                transparent
            );
            position: relative;
            overflow: visible;
        }

        /* 在分割线中间加入一个小的装饰点，增加 UI 精致度 */
        .prose hr::after {
            content: "SECTION_END";
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%) skewX(-15deg);
            background: var(--p3-dark);
            padding: 0 1rem;
            color: var(--p3-blue);
            font-size: 10px;
            font-weight: bold;
            letter-spacing: 0.2rem;
            opacity: 0.8;
        }

        /* 1. 让所有的一级标题带上色块和斜切感 */
        .prose h1 {
            background: #0066ff;
            color: white !important;
            padding: 0.5rem 1rem;
            transform: skewX(-10deg);
            display: inline-block;
            margin-top: 2rem !important;
            box-shadow: 6px 6px 0px #000b1a;
        }

        /* 2. 让二级标题带上底部装饰线 */
        .prose h2 {
            border-left: 6px solid #0066ff;
            padding-left: 0.75rem;
            font-style: italic;
            color: #0044cc !important;
            text-transform: uppercase;
        }

        .prose table {
            display: block;
            width: 100%;
            overflow: auto;
            border-spacing: 0;
            border-collapse: collapse;
        }

        .prose table tr {
            background-color: #fff;
            border-top: 1px solid #ccc;
        }

        /* 隔行变色 */
        .prose table tr:nth-child(2n) {
            background-color: #f8f8f8;
        }

        .prose table th, .prose table td {
            padding: 6px 13px;
            border: 1px solid #ddd;
        }

        .prose table th {
            font-weight: bold;
            background-color: #f2f2f2;
        }

        /* 3. 代码块美化：加入“系统终端”感 */
        .prose pre {
            background: #dce2eb !important;
            border-left: 4px solid #00d9ff;
            border-top: 1px solid rgba(0, 217, 255, 0.2);
            box-shadow: 10px 10px 20px rgba(0, 0, 0, 0.2);
            position: relative;
        }

        /* 行内代码 */
        .prose :not(pre) > code {
            background-color: #0066ff !important;
            color: white !important;
            padding: 0.1rem 0.4rem !important;
            font-style: normal !important;
        }
        .prose :not(pre) > code::before, .prose :not(pre) > code::after { content: "" !important; }

        /* 4. 让链接具有动态感 */
        .prose a {
            background: linear-gradient(0deg, #0066ff 2px, transparent 2px);
            transition: all 0.2s;
            font-weight: bold;
            color: #0066ff !important;
        }
        .prose a:hover {
            background: #0066ff;
            color: white !important;
        }
        .drop-shadow-blue-glow {
            filter: drop-shadow(0 0 8px rgba(0, 102, 255, 0.8)) 
                    drop-shadow(0 0 15px rgba(0, 217, 255, 0.4));
        }

        /* 模拟 P3R 的缓慢漂浮感 */
        @keyframes moonSway {
            0%, 100% { transform: rotate(-5deg) translate(0, 0); }
            50% { transform: rotate(5deg) translate(-5px, -5px); }
        }
        .animate-moon-sway {
            animation: moonSway 4s ease-in-out infinite;
        }

        /* 像素扫描线 */
        .bg-scanlines {
            background: linear-gradient(
                to bottom,
                transparent 50%,
                rgba(0, 102, 255, 0.2) 50%
            );
            background-size: 100% 4px;
        }

        /* 隐藏原生滑块，但保留功能 */
        #volume-slider::-webkit-slider-runnable-track { background: transparent; }
        #volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 10px;
            height: 40px; /* 增加感应面积 */
            background: transparent;
        }
        #music-toggle.is-playing {
            animation: pulse-blue 2s infinite;
            background-color: var(--p3-blue);
            color: white;
        }

        @keyframes pulse-blue {
            0% { box-shadow: 0 0 0 0 rgba(0, 102, 255, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(0, 102, 255, 0); }
            100% { box-shadow: 0 0 0 0 rgba(0, 102, 255, 0); }
        }
    </style>
</head>

<div class="fixed bottom-24 right-8 z-[100] group flex items-center gap-4 flex-row-reverse">
    
    <button id="music-toggle" class="w-14 h-14 bg-white text-black slanted-box shadow-[5px_5px_0px_#0066ff] hover:bg-blue-500 hover:text-white transition-all flex items-center justify-center relative">
        <div class="slanted-content">
            <svg id="play-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <svg id="pause-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        </div>
    </button>

    <div class="flex flex-col items-end opacity-0 group-hover:opacity-100 transition-all duration-300 translate-x-4 group-hover:translate-x-0">
        <div class="bg-blue-600 text-white px-3 py-1 slanted-box mb-2">
            <div class="slanted-content italic font-bold text-[10px] tracking-tighter">
                COLOR YOUR NIGHT
            </div>
        </div>
        
        <div class="w-32 h-6 bg-slate-900/80 slanted-box border border-blue-500/50 p-1 flex items-center relative overflow-hidden">
            <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="0.3" 
                   class="w-full h-full opacity-0 absolute inset-0 z-10 cursor-pointer">
            <div class="w-full h-full bg-blue-900/30 overflow-hidden relative">
                <div id="volume-fill" class="h-full bg-cyan-400 shadow-[0_0_10px_#00ffff]" style="width: 30%;"></div>
                <div class="absolute inset-0 flex justify-between pointer-events-none">
                    <div class="w-[1px] h-full bg-black/20"></div>
                    <div class="w-[1px] h-full bg-black/20"></div>
                    <div class="w-[1px] h-full bg-black/20"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<audio id="bgm" loop>
    <source src="/music/color-your-night.mp3" type="audio/mpeg">
</audio>

<script>
    const bgm = document.getElementById('bgm');
    const toggleBtn = document.getElementById('music-toggle');
    const playIcon = document.getElementById('play-icon');
    const pauseIcon = document.getElementById('pause-icon');
    
    const volumeSlider = document.getElementById('volume-slider');
    const volumeFill = document.getElementById('volume-fill');

    // 1. 初始化设置
    bgm.volume = 0.3; // 初始音量 30%

    // 2. 播放/暂停控制
    toggleBtn.addEventListener('click', () => {
        if (bgm.paused) {
            bgm.play();
            toggleBtn.classList.add('is-playing', 'bg-blue-600', 'text-white');
            playIcon.classList.add('hidden');
            pauseIcon.classList.remove('hidden');
        } else {
            bgm.pause();
            toggleBtn.classList.remove('is-playing', 'bg-blue-600', 'text-white');
            playIcon.classList.remove('hidden');
            pauseIcon.classList.add('hidden');
        }
    });

    // 3. 音量调节控制
    volumeSlider.addEventListener('input', (e) => {
        const val = e.target.value;
        bgm.volume = val; // 更新音频音量
        volumeFill.style.width = (val * 100) + '%'; // 更新进度条显示
    });
</script>

<body class="bg-gradient-animate min-h-screen">
    <div class="shard w-64 h-64 top-20 left-[5%]"></div>
    <div class="shard w-96 h-96 bottom-10 right-[2%]" style="animation-delay: -2s;"></div>

    <nav class="flex justify-between items-center p-8 sticky top-0 z-50">
        <div class="text-4xl font-black italic tracking-tighter">
            <a href="/"><span class="text-white">P3R</span><span class="text-blue-500">BLOG</span></a>
        </div>
        <div class="flex gap-4">
            <a href="/" class="slanted-box bg-white text-black px-6 py-1 hover:bg-blue-500 hover:text-white transition-all">
                <div class="slanted-content font-bold underline">RECALL</div>
            </a>
        </div>
    </nav>

    <%- body %>

    <footer class="mt-20 p-12 bg-blue-600 slanted-box -mb-10 ml-10">
        <div class="slanted-content text-right text-white italic font-bold">
            <p>© <%= new Date().getFullYear() %> OPERATION MEMENTO. </span> // ARCHIVE BY <%= config.author %></p>
        </div>
    </footer>

    <div class="bg-black pt-16 pb-12 overflow-hidden border-t-4 border-blue-400 relative z-10">
        <div class="container mx-auto px-8">
            <div class="flex items-center gap-4 mb-6">
                <h3 class="text-blue-500 font-black italic text-2xl tracking-tighter uppercase">S.Link Contacts</h3>
                <div class="h-[2px] flex-1 bg-gradient-to-r from-blue-500 to-transparent"></div>
            </div>

            <div class="flex flex-wrap gap-6 justify-end">
                <% (config.friends || []).forEach(function(friend){ %>
                    <a href="<%= friend.url %>" target="_blank" class="group relative">
                        <div class="flex items-center gap-3 bg-white/5 px-4 py-2 border-r-4 border-transparent group-hover:border-blue-500 group-hover:bg-white transition-all duration-300 transform -skew-x-12">
                            <div class="flex items-center gap-3 transform skew-x-12">
                                <span class="text-blue-400 font-mono text-[10px] group-hover:text-blue-600">RANK MAX</span>
                                <span class="text-white group-hover:text-black font-bold italic tracking-tight uppercase text-sm">
                                    <%= friend.name %>
                                </span>
                            </div>
                        </div>
                    </a>
                <% }) %>
            </div>
        </div>
        
        <div class="absolute -bottom-4 -left-4 text-white/5 text-8xl font-black italic select-none pointer-events-none">
            SOCIAL LINKS
        </div>
    </div>
</body>
</html> -->


<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%- page.title || config.title %> - <%= config.author %></title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/pjax/pjax.js"></script>
    <style>
        /* 样式部分保持不变，包含 P3R 风格的蓝色调、斜切盒模型、背景动画及漂浮碎片动画 */
        @import url('https://fonts.googleapis.com/css2?family=Oswald:wght@700&display=swap');
        :root { --p3-blue: #0066ff; --p3-dark: #000b1a; }
        body { background-color: var(--p3-dark); color: white; font-family: 'Oswald', sans-serif; overflow-x: hidden; }
        
        /* 背景渐变动画：模拟 P3R 的深蓝流动感 */
        .bg-gradient-animate {
            background: linear-gradient(135deg, #000b1a 0%, #001a3d 50%, #002e66 100%);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
        }
        @keyframes gradientBG { 0%, 100% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } }
        
        /* 基础变形样式：斜切容器与内容反向修复 */
        .slanted-box { transform: skewX(-15deg); }
        .slanted-content { transform: skewX(15deg); }
        
        /* 漂浮碎片：在背景中做不规则浮动 */
        .shard { position: fixed; background: rgba(0, 102, 255, 0.15); clip-path: polygon(20% 0%, 80% 0%, 100% 100%, 0% 80%); z-index: -1; animation: float 8s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0) rotate(0deg); } 50% { transform: translateY(-30px) rotate(5deg); } }
        
        /* P3R 经典的页面切入动画：从左侧划入并带有斜切感 */
        @keyframes p3SlideIn {
            0% { transform: translateX(-40px) skewX(-15deg); opacity: 0; }
            100% { transform: translateX(0) skewX(0); opacity: 1; }
        }
        .animate-p3-slide {
            animation: p3SlideIn 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        /* Prose 内容样式定制：包含引用、链接、分割线、标题及代码块的 P3R 风格美化 */
        .prose blockquote { border-left: 4px solid #0066ff !important; background: #f0f7ff; padding: 1rem !important; font-style: italic; }
        .prose a { color: #0066ff; text-decoration: none; border-bottom: 2px solid transparent; transition: all 0.3s; font-weight: bold; }
        .prose a:hover { border-bottom: 2px solid #00d9ff; background: rgba(0, 102, 255, 0.1); }
        .prose { color: #1a1a1a; }
        .prose hr { margin-top: 4rem !important; margin-bottom: 4rem !important; border: none; height: 2px; background: linear-gradient(to right, transparent, var(--p3-blue) 15%, #00d9ff 50%, var(--p3-blue) 85%, transparent); position: relative; overflow: visible; }
        .prose hr::after { content: "SECTION_END"; position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%) skewX(-15deg); background: var(--p3-dark); padding: 0 1rem; color: var(--p3-blue); font-size: 10px; font-weight: bold; letter-spacing: 0.2rem; opacity: 0.8; }
        .prose h1 { background: #0066ff; color: white !important; padding: 0.5rem 1rem; transform: skewX(-10deg); display: inline-block; margin-top: 2rem !important; box-shadow: 6px 6px 0px #000b1a; }
        .prose h2 { border-left: 6px solid #0066ff; padding-left: 0.75rem; font-style: italic; color: #0044cc !important; text-transform: uppercase; }
        .prose table { display: block; width: 100%; overflow: auto; border-spacing: 0; border-collapse: collapse; }
        .prose table tr { background-color: #fff; border-top: 1px solid #ccc; }
        .prose table tr:nth-child(2n) { background-color: #f8f8f8; }
        .prose table th, .prose table td { padding: 6px 13px; border: 1px solid #ddd; }
        .prose table th { font-weight: bold; background-color: #f2f2f2; }
        .prose pre { background: #dce2eb !important; border-left: 4px solid #00d9ff; border-top: 1px solid rgba(0, 217, 255, 0.2); box-shadow: 10px 10px 20px rgba(0, 0, 0, 0.2); position: relative; }
        .prose :not(pre) > code { background-color: #0066ff !important; color: white !important; padding: 0.1rem 0.4rem !important; font-style: normal !important; }
        .prose :not(pre) > code::before, .prose :not(pre) > code::after { content: "" !important; }
        .prose a { background: linear-gradient(0deg, #0066ff 2px, transparent 2px); transition: all 0.2s; font-weight: bold; color: #0066ff !important; }
        .prose a:hover { background: #0066ff; color: white !important; }
        
        /* 辅助样式：光晕效果、月亮晃动、扫描线 */
        .drop-shadow-blue-glow { filter: drop-shadow(0 0 8px rgba(0, 102, 255, 0.8)) drop-shadow(0 0 15px rgba(0, 217, 255, 0.4)); }
        @keyframes moonSway { 0%, 100% { transform: rotate(-5deg) translate(0, 0); } 50% { transform: rotate(5deg) translate(-5px, -5px); } }
        .animate-moon-sway { animation: moonSway 4s ease-in-out infinite; }
        .bg-scanlines { background: linear-gradient( to bottom, transparent 50%, rgba(0, 102, 255, 0.2) 50% ); background-size: 100% 4px; }
        
        /* 音量条滑块自定义设置 */
        #volume-slider::-webkit-slider-runnable-track { background: transparent; }
        #volume-slider::-webkit-slider-thumb { -webkit-appearance: none; width: 10px; height: 40px; background: transparent; }
        
        /* 播放器激活时的呼吸灯动画 */
        #music-toggle.is-playing { animation: pulse-blue 2s infinite; background-color: var(--p3-blue); color: white; }
        @keyframes pulse-blue { 0% { box-shadow: 0 0 0 0 rgba(0, 102, 255, 0.7); } 70% { box-shadow: 0 0 0 15px rgba(0, 102, 255, 0); } 100% { box-shadow: 0 0 0 0 rgba(0, 102, 255, 0); } }
    </style>
</head>

<body class="bg-gradient-animate min-h-screen">
    <div class="shard w-64 h-64 top-20 left-[5%]"></div>
    <div class="shard w-96 h-96 bottom-10 right-[2%]" style="animation-delay: -2s;"></div>

    <div id="music-system-fixed" class="fixed bottom-24 right-8 z-[100] group flex items-center gap-4 flex-row-reverse">
        <button id="music-toggle" class="w-14 h-14 bg-white text-black slanted-box shadow-[5px_5px_0px_#0066ff] hover:bg-blue-500 hover:text-white transition-all flex items-center justify-center relative">
            <div class="slanted-content">
                <svg id="play-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <svg id="pause-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
            </div>
        </button>
        <div class="flex flex-col items-end opacity-0 group-hover:opacity-100 transition-all duration-300 translate-x-4 group-hover:translate-x-0">
            <div class="bg-blue-600 text-white px-3 py-1 slanted-box mb-2 italic font-bold text-[10px]">COLOR YOUR NIGHT</div>
            <div class="w-32 h-6 bg-slate-900/80 slanted-box border border-blue-500/50 p-1 flex items-center relative overflow-hidden">
                <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="0.3" class="w-full h-full opacity-0 absolute inset-0 z-10 cursor-pointer">
                <div class="w-full h-full bg-blue-900/30 overflow-hidden relative">
                    <div id="volume-fill" class="h-full bg-cyan-400 shadow-[0_0_10px_#00ffff]" style="width: 30%;"></div>
                </div>
            </div>
        </div>
    </div>
    <audio id="bgm" loop><source src="/music/color-your-night.mp3" type="audio/mpeg"></audio>

    <div id="pjax-container">
        <nav class="flex justify-between items-center p-8 sticky top-0 z-50">
            <div class="text-4xl font-black italic tracking-tighter">
                <a href="/"><span class="text-white">P3R</span><span class="text-blue-500">BLOG</span></a>
            </div>
            <div class="flex gap-4">
                <a href="/" class="slanted-box bg-white text-black px-6 py-1 hover:bg-blue-500 hover:text-white transition-all">
                    <div class="slanted-content font-bold underline">RECALL</div>
                </a>
            </div>
        </nav>

        <%- body %>

        <footer class="mt-20 p-12 bg-blue-600 slanted-box -mb-10 ml-10">
            <div class="slanted-content text-right text-white italic font-bold">
                <p>© <%= new Date().getFullYear() %> OPERATION MEMENTO. // ARCHIVE BY <%= config.author %></p>
            </div>
        </footer>

        <div class="bg-black pt-16 pb-12 overflow-hidden border-t-4 border-blue-400 relative z-10">
            <div class="container mx-auto px-8">
                <div class="flex items-center gap-4 mb-6"><h3 class="text-blue-500 font-black italic text-2xl tracking-tighter uppercase">S.Link Contacts</h3><div class="h-[2px] flex-1 bg-gradient-to-r from-blue-500 to-transparent"></div></div>
                <div class="flex flex-wrap gap-6 justify-end">
                    <% (config.friends || []).forEach(function(friend){ %>
                        <a href="<%= friend.url %>" target="_blank" class="group relative">
                            <div class="flex items-center gap-3 bg-white/5 px-4 py-2 border-r-4 border-transparent group-hover:border-blue-500 group-hover:bg-white transition-all duration-300 transform -skew-x-12">
                                <div class="flex items-center gap-3 transform skew-x-12"><span class="text-white group-hover:text-black font-bold italic text-sm"><%= friend.name %></span></div>
                            </div>
                        </a>
                    <% }) %>
                </div>
            </div>
            <div class="absolute -bottom-4 -left-4 text-white/5 text-8xl font-black italic select-none pointer-events-none">SOCIAL LINKS</div>
        </div>
    </div>

    <script>
        // 1. 初始化 Pjax：监听所有站内链接，点击时仅局部更新标题和 pjax-container
        var pjax = new Pjax({
            selectors: ["title", "#pjax-container"],
            elements: "a[href^='/']:not([target='_blank'])",
            cacheBust: false
        });

        // 2. 音乐播放逻辑：只在页面首次加载时运行一次，维持全局状态
        const bgm = document.getElementById('bgm');
        const toggleBtn = document.getElementById('music-toggle');
        const playIcon = document.getElementById('play-icon');
        const pauseIcon = document.getElementById('pause-icon');
        const volumeSlider = document.getElementById('volume-slider');
        const volumeFill = document.getElementById('volume-fill');

        bgm.volume = 0.3; // 默认音量

        // 按钮点击控制播放/暂停，同步切换 UI 图标与呼吸动画
        toggleBtn.addEventListener('click', () => {
            if (bgm.paused) {
                bgm.play();
                toggleBtn.classList.add('is-playing', 'bg-blue-600', 'text-white');
                playIcon.classList.add('hidden'); pauseIcon.classList.remove('hidden');
            } else {
                bgm.pause();
                toggleBtn.classList.remove('is-playing', 'bg-blue-600', 'text-white');
                playIcon.classList.remove('hidden'); pauseIcon.classList.add('hidden');
            }
        });

        // 音量滑动条监听，实时更新音频音量与视觉进度条宽度
        volumeSlider.addEventListener('input', (e) => {
            bgm.volume = e.target.value;
            volumeFill.style.width = (e.target.value * 100) + '%';
        });

        // 3. 找回页面切换动画：Pjax 完成替换后，DOM 节点被更新，需手动重置 CSS 动画类
        document.addEventListener('pjax:complete', function() {
            // 找到所有需要切入动画的元素（如正文、特定动画类）
            const animatedElements = document.querySelectorAll('.animate-p3-slide, .prose');
            animatedElements.forEach(el => {
                // 先清除动画，通过 offsetHeight 触发浏览器重绘(Reflow)，再恢复动画，强制重新播放
                el.style.animation = 'none';
                el.offsetHeight; 
                el.style.animation = '';
            });
        });
    </script>
</body>
</html>